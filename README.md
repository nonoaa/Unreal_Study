# Unreal_Study

## Chapter 2 : 액터의 설계
### 언리얼 콘텐츠의 구성 요소
#### 월드
- 공간
- 시간
- 물리
- 렌더링

#### 액터
- 언리얼 엔진에서 콘텐츠를 구성하는 최소 단위의 물체
- 액터의 구성 요소
  - 이름
  - 유형: 액터의 클래스 이름
  - 트랜스폼
  - 프로퍼티: 액터에 설정된 속성 값
  - 게임 로직: 액터에 특정 상황이 발생할 때 이에 대응할 구체적인 행동을 명령하기 위해서는 프로그래밍 코드가 필요하다. 이를 게임 로직이라 하며, 언리얼 엔진은 블루프린트와 C++라는 두 가지 언어를 지원한다.
  
#### 레벨
- 플레이어에게 주어지는 스테이지를 의미한다. (유니티에서 Scene과 비슷)

#### 컴포넌트
- 언리얼 엔진에서 제공하는 주요 컴포넌트
  - 스태틱메시 컴포넌트: 애니메이션이 없는 모델링 애셋인 스태틱메시를 사용해 시각적인 기능과 물리적인 기능을 제공하는 모듈이다. 주로 배경 물체에 사용한다.
  - 스켈레탈메시 컴포넌트: 애니메이션 정보가 있는 모델링 애셋인 스켈레탈 메시를 사용해 시각적인 기능과 애니메이션, 그리고 캐릭터의 물리 기능을 제공하는 모듈이다. 주로 캐릭터에 사용한다.
  - 콜리전 컴포넌트: 구/박스/캡슐로 지정한 영역에 물리적인 기능을 설정하기 위해 제공하는 모듈이다. 시각적인 기능은 없다.
  - 카메라 컴포넌트: 가상 세계에서 보여지는 현재 상황을 플레이어의 모니터 화면에 출력해주는 기능이다.
  - 오디오 컴포넌트: 가상 세계에서 소리를 발생시키는데 사용하는 기능이다.
  - 파티클 시스템 컴포넌트: 파티클 시스템으로 설계된 이펙트를 화면에 보여주기 위한 기능이다.
  - 라이트 컴포넌트: 전구, 헤드라이트 등과 같이 물체에 광원 효과를 부여하는 기능이다.
  - 무브먼트 컴포넌트: 물체에 특정한 움직임을 부여하는 기능이다.
- 액터는 여러 개의 컴포넌트를 가질 수 있으며, 그 중에서 대표하는 하나의 컴포넌트(루트 컴포넌트)를 반드시 지정해야 한다.

### 액터의 설계
- C++에서 액터가 두 개의 스태틱메시 컴포넌트를 가지려면 액터의 멤버 변수로 두 개의 UStaticMeshComponent 클래스의 포인터를 선언해줘야 한다. 이때 헤더 파일에 선언된 CoreMinimal.h 파일을 EngineMinimal.h 파일로 변경해 액터 클래스가 UStaticMeshComponent 클래스 정보를 참조할 수 있도록 설정해야 한다.
- 언리얼 엔진에서는 언리얼 실행 환경(Runtime)을 통해 메모리가 할당된 객체가 더 이상 사용되지 않으면 메모리를 자동으로 소멸시키는 기능을 제공한다.
  - 언리얼 실행 환경이 객체를 자동으로 관리하게 만드려면 UPROPERTY라는 매크로를 사용해 객체를 지정해줘야 한다.
  - 언리얼 오브젝트라는 객체에만 적용할 수 있다.
    - 언리얼 오브젝트는 언리얼 실행 환경에 의해 관리되는 C++ 객체이다.
    - 어떤 C++ 클래스가 언리얼 오브젝트 클래스가 되려면 클래스 선언에 다음과 같은 언리얼 엔진이 정의한 특별한 매크로와 규칙을 부여해야 한다.
      - 클래스 선언 매크로: 해당 클래스가 언리얼 오브젝트임을 선언하기 위한 매크로다. 클래스 선언의 윗줄에 UCLASS라는 매크로를 선언하고 클래스 내부에는 GENERATED_BODY 매크로를 선언한다.
      - 클래스 이름 접두사: 언리얼 오브젝트에는 항상 규칙에 맞게 접두사가 붙어야 한다. 접두사는 크게 U와 A가 제공되는데, A는 액터 클래스에 사용하고 U는 액터가 아닌 클래스에 사용한다.
      - generated.h 헤더 파일: 소스 코드를 컴파일하기 이전에 언리얼 엔진은 '언리얼 헤더 툴'이라는 도구를 사용해 클래스 선언을 분석하고 언리얼 실행 환경에 필요한 부가 정보를 별도의 파일에 생성한다. 언리얼 헤더 툴에 의해 자동으로 생성되는 부가 파일이 generated.h 파일이다. 코드를 작성하는 시점에 이 파일은 존재하지 않지만 컴파일 과정에서 필연적으로 발생하기 때문에 언리얼 오브젝트 선언의 마지막 #include 구문에 이 헤더 파일을 반드시 선언해야 한다.
      - 외부 모듈에의 공개 여부: 윈도우의 DLL 시스템은 DLL 내 클래스 정보를 외부에 공개할지 결정하는 _declspec(dllexport)라는 키워드를 제공한다. 언리얼 엔진에서 이 키워드를 사용하려면 '모듈명_API'라는 키워드를 클래스 선언 앞에 추가한다. 이 키워드가 없으면 다른 모듈에서 해당 객체에 접근할 수 없다.
- 생성자 코드에서 컴포넌트를 생성하는 용도로 언리얼 엔진은 new가 아닌 CreateDefaultSubobject API라는 함수를 사용한다.
